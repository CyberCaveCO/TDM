
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"Detect Exploitation attempt on Microsoft SharePoint OAuth authentication bypass attempt"; flow:to_server,established; content:"Authorization|3A|"; nocase; http_header; content:"Bearer"; http_header; content:"|22|alg|22|"; nocase; content:"|22|none|22|"; nocase; content:"/_api/"; fast_pattern:only; http_uri; pcre:"/\x2f_api\x2f(web\x2f|lists\x2f|Microsoft|SP\x2e|_vti_bin|_layouts|apps\x2f|search\x2f)/Ui"; reference:cve,2023-29357; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2023-29357; sid:2023092901; rev:1;)
