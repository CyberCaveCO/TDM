title: Suspicious Exchange Management Shell Access
status: experimental
description: Detects suspicious PowerShell WSMan activity that might indicate unauthorized access or exploitation of an Exchange server.
author: CyberCave
date: 2023-10-25
logsource:
    product: windows
    service: powershell
    category: process_creation
detection:
    selection1:
        EventID: 4688   # Process Creation Event
        NewProcessName: '*\powershell.exe'
        ProcessCommandLine: '*-configurationname Microsoft.Exchange*'
    selection2:
        EventID: 4104   # PowerShell Script Block Logging
        ScriptBlockText: '*Get-Mailbox*'
    condition: selection1 and selection2
falsepositives:
    - Legitimate Exchange server management by authorized administrators.
level: high
tags:
    - attack.execution
    - attack.t1086
