alert tcp any any -> any any (msg:"Possible ProxyNotShell Exploitation attempt CVE-2022-41040 and CVE-2022-41082";  content:"autodiscover/autodiscover.json?"; content:"&Email=autodiscover/autodiscover.json"; nocase; http_uri;  sid:2022093002; rev:1;)

alert tcp any any -> [$HOME_NET,$HTTP_SERVERS,$SMTP_SERVERS] [$HTTP_PORTS,444] (msg:"ET EXPLOIT Microsoft Exchange Remote Code Execution Attempt (CVE-2022-41040, CVE-2022-41082)"; flow:established,to_server; content:"POST"; depth:5; content:"autodiscover.json"; nocase; fast_pattern; distance:0; content:"|40|"; distance:0; content:"Powershell"; nocase; distance:0; reference:url,msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/; classtype:attempted-admin; sid:2039065; rev:1; metadata:affected_product MS_Exchange, attack_target Server, created_at 2022_09_30, cve CVE_2022_41040_CVE_2022_41082, deployment Perimeter, deployment Internal, deployment SSLDecrypt, former_category EXPLOIT, performance_impact Low, confidence High, signature_severity Major, updated_at 2022_09_30;)

alert tcp any any -> any any (msg:"Detect Possible Exploitation attempt against CVE-2022-41040 and CVE-2022-41082 PorxyNotShell v1"; content:"/autodiscover/admin@localhost/%s/autodiscover.json?x=a"; content:"autodiscover/admin@localhost"; http_cookie; reference:url,github.com/testanull/ProxyNotShell-PoC/blob/main/poc_aug3.py; classtype:trojan-activity; sid:2022111701; rev:1;)

alert tcp any any -> any any (msg:"Detect Possible Exploitation attempt against CVE-2022-41040 and CVE-2022-41082 PorxyNotShell v2"; content:"/autodiscover"; content:"autodiscover.json?x="; content:"autodiscover"; http_cookie; reference:url,github.com/testanull/ProxyNotShell-PoC/blob/main/poc_aug3.py; classtype:trojan-activity; sid:2022111702; rev:1;)
