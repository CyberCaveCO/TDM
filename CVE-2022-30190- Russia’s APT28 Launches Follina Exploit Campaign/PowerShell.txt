Get-WinEvent | where {((($_.message -match "Image.*.*winword.exe") -or (($_.message -match "Image.*.*wordpad.exe") -and ($_.message -match "CommandLine.*.*msdt.exe.*") -and ($_.message -match "CommandLine.*.*PCWDiagnostic.*") -and ($_.message -match "CommandLine.*.*IT_BrowserForFile.*" -or $_.message -match "CommandLine.*.*IT_LaunchMethod.*"))) -or (($_.message -match "C:\\Windows\\System32\\cmd.exe") -and ($_.message -match "CommandLine.*.*/k powershell.*" -or $_.message -match "CommandLine.*.*docx.exe.*" -or $_.message -match "CommandLine.*.*-NoProfile -command.*" -or $_.message -match "CommandLine.*.*Start-Process.*"))) } | select TimeCreated,Id,RecordId,ProcessId,MachineName,Message
