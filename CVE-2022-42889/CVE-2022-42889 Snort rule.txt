alert tcp $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] $HTTP_PORTS (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt Script Prefix (CVE-2022-42889) (Inbound)"; flow:established,to_server; content:"search|3d 24 7b|script|3a|javascript|3a|java|2e|lang|2e|Runtime|2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,sysdig.com/blog/cve-2022-42889-text4shell; classtype:attempted-admin; sid:2039464; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt Script Prefix (CVE-2022-42889) (Outbound)"; flow:established,to_server; content:"search|3d 24 7b|script|3a|javascript|3a|java|2e|lang|2e|Runtime|2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,sysdig.com/blog/cve-2022-42889-text4shell; classtype:attempted-admin; sid:2039465; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] $HTTP_PORTS (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt DNS Prefix (CVE-2022-42889) (Inbound)"; flow:established,to_server; content:"search|3d 24 7b|dns|3a|javascript|3a|java|2e|lang|2e|Runtime|2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,sysdig.com/blog/cve-2022-42889-text4shell; classtype:attempted-admin; sid:2039466; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $HOME_NET any -> any any (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt DNS Prefix (CVE-2022-42889) (Outbound)"; flow:established,to_server; content:"search|3d 24 7b|dns|3a|javascript|3a|java|2e|lang|2e|Runtime|2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,sysdig.com/blog/cve-2022-42889-text4shell; classtype:attempted-admin; sid:2039467; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt URL Prefix (CVE-2022-42889) (Inbound)"; flow:established,to_server; content:"search|3d 24 7b|url|3a|javascript|3a|java|2e|lang|2e|Runtime|2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,sysdig.com/blog/cve-2022-42889-text4shell; classtype:attempted-admin; sid:2039468; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $HOME_NET any -> any any (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt URL Prefix (CVE-2022-42889) (Outbound)"; flow:established,to_server; content:"search|3d 24 7b|url|3a|javascript|3a|java|2e|lang|2e|Runtime|2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,sysdig.com/blog/cve-2022-42889-text4shell; classtype:attempted-admin; sid:2039469; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Client_Endpoint, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt JEXL Path (CVE-2022-42889) (Inbound)"; flow:established,to_server; content:"|24 7b|java|3a|version|7d 20 24 7b|script|3a|JEXL|3a 27 27 2e|getClass|28 29 2e|forName|28 27|java|2e|lang|2e|Runtime|27 29 2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,twitter.com/pwntester/status/1582321752566161409; classtype:attempted-admin; sid:2039470; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)

alert tcp $HOME_NET any -> any any (msg:"ET EXPLOIT Possible Apache Text4shell RCE Attempt JEXL Path (CVE-2022-42889) (Outbound)"; flow:established,to_server; content:"|24 7b|java|3a|version|7d 20 24 7b|script|3a|JEXL|3a 27 27 2e|getClass|28 29 2e|forName|28 27|java|2e|lang|2e|Runtime|27 29 2e|getRuntime|28 29 2e|exec|28 27|"; http_uri; fast_pattern; content:"|27 29 7d|"; http_uri; pcre:"/|27\x2029\x207d|$/U"; reference:cve,2022-42889; reference:url,twitter.com/pwntester/status/1582321752566161409; classtype:attempted-admin; sid:2039471; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Web_Server, created_at 2022_10_19, cve CVE_2022_42889, deployment Perimeter, deployment SSLDecrypt, former_category EXPLOIT, confidence Medium, signature_severity Major, updated_at 2022_10_19;)
